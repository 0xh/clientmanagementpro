/**
 * bcat BG Switcher - unobtrusive background image switcher
 * @version 1.2.0
 * @jQuery version 1.2+
 * @author Yuriy Davats http://www.bcat.eu
 * @copyright Yuriy Davats
 */
!function(a){function g(a,b){this._defaults=f,this._name=e,this.init(a,b)}var e="bcatBGSwitcher",f={urls:[],startIndex:0,timeout:12e3,alt:"Picture",speed:1e3,links:!1};g.prototype={init:function(b,c){var d={};d.currentIndex=c.startIndex,d.currentImage=this.preloadImage(b,c,d.currentIndex);var e=this;d.currentImage.load(function(){if(d.currentImage.appendTo(b),d.currentImage.fadeIn(c.speed),d.currentIndex++,c.urls[d.currentIndex]){if(c.links){var f=a("<div />").attr({id:b.id+"-loader",style:"display: none;"});f.appendTo(b),e.generateLinks(b,c,d)}e.runSlideShow(b,c,d)}})},runSlideShow:function(a,b,c){var d=this;c.intervalId=setInterval(function(){d.updateImage(a,b,c)},b.timeout)},updateImage:function(b,c,d){c.urls[d.currentIndex]||(d.currentIndex=0);var e=a("#"+b.id+d.currentIndex);e.length?(d.currentImage.fadeOut(c.speed),e.fadeIn(c.speed)):(e=this.preloadImage(b,c,d.currentIndex),this.swapPreloadedImages(d.currentImage,e,b,c)),c.links&&this.setActiveLink(b,c,d),d.currentImage=e,d.currentIndex++},preloadImage:function(b,c,d,e){e||(e="display: none;");var f=a("<img />");return f.attr({id:b.id+d,src:c.urls[d],alt:c.alt,style:e}),f},swapPreloadedImages:function(b,c,d,e,f){f&&a(d).addClass("loading"),c.load(function(){f&&a(d).removeClass("loading"),c.appendTo(d),b.fadeOut(e.speed),c.fadeIn(e.speed)})},generateLinks:function(b,c,d){d.linkParent=a("<div />"),d.linkParent.attr({id:b.id+"-navigation",style:"display: none;"});var e=this;a.each(c.urls,function(f){var h=a("<a />"),i="";f===c.startIndex&&(i="active"),h.attr({id:b.id+"-link"+f,href:"#","class":i}),h.click(function(a){a.preventDefault(),e.switchImageTo(b,c,d,f)}),d.linkParent.append(h)}),d.linkParent.insertAfter(b),d.linkParent.fadeIn(c.speed)},switchImageTo:function(b,c,d,e){if(!c.urls[e])return console.log("can not switch to a non-existent element"),void 0;var f=a("#"+b.id+e);if(f.attr("id")!==d.currentImage.attr("id")){d.currentIndex=e,clearInterval(d.intervalId),f.length?(d.currentImage.fadeOut(c.speed),f.fadeIn(c.speed)):(f=this.preloadImage(b,c,d.currentIndex),this.swapPreloadedImages(d.currentImage,f,b,c,!0)),this.setActiveLink(b,c,d),d.currentImage=f,d.currentIndex++;var g=this;d.intervalId=setInterval(function(){g.updateImage(b,c,d)},c.timeout)}},setActiveLink:function(a,b,c){c.linkParent.length&&(c.linkParent.find("a").removeClass("active"),c.linkParent.find("a#"+a.id+"-link"+c.currentIndex).addClass("active"))}},a.fn[e]=function(b){return this.each(function(){if(!a.data(this,"plugin_"+e)){var c=a.extend({},f,b);a.data(this,"plugin_"+e,new g(this,c))}})}}(jQuery,window,document);